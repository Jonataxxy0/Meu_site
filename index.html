<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IA 3D Simulator - Deep Learning Concept</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: sans-serif; }
        #ui {
            position: absolute;
            top: 20px;
            left: 20px;
            color: #00ff00;
            background: rgba(0,0,0,0.7);
            padding: 15px;
            border: 1px solid #00ff00;
            border-radius: 5px;
            pointer-events: none;
        }
        .controls { color: #fff; font-size: 12px; margin-top: 10px; }
    </style>
</head>
<body>

    <div id="ui">
        <strong>SISTEMA DE IA: ATIVO</strong><br>
        Status: <span id="ia-status">Rastreando Alvo...</span><br>
        Distância: <span id="distancia">0</span>
        <div class="controls">Use WASD ou Setas para fugir da IA</div>
    </div>

    <script type="module">
        import * as THREE from 'https://cdn.skypack.dev/three@0.136.0';

        // 1. Configuração da Cena
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // Iluminação
        const light = new THREE.PointLight(0xffffff, 1, 100);
        light.position.set(10, 10, 10);
        scene.add(light);
        scene.add(new THREE.AmbientLight(0x404040));

        // Chão (Grid)
        const grid = new THREE.GridHelper(100, 50, 0x00ff00, 0x222222);
        scene.add(grid);

        // 2. O Jogador (Esfera Azul)
        const playerGeo = new THREE.SphereGeometry(0.5, 32, 32);
        const playerMat = new THREE.MeshStandardMaterial({ color: 0x0077ff });
        const player = new THREE.Mesh(playerGeo, playerMat);
        player.position.y = 0.5;
        scene.add(player);

        // 3. A Inteligência Artificial (Cubo Vermelho)
        const iaGeo = new THREE.BoxGeometry(1, 1, 1);
        const iaMat = new THREE.MeshStandardMaterial({ color: 0xff0000 });
        const enemyIA = new THREE.Mesh(iaGeo, iaMat);
        enemyIA.position.set(5, 0.5, 5);
        scene.add(enemyIA);

        camera.position.set(0, 10, 15);
        camera.lookAt(0, 0, 0);

        // Controles do Jogador
        const keys = {};
        window.addEventListener('keydown', (e) => keys[e.key.toLowerCase()] = true);
        window.addEventListener('keyup', (e) => keys[e.key.toLowerCase()] = false);

        // 4. Lógica da IA (Algoritmo de Perseguição)
        function updateIA() {
            const speed = 0.03;
            
            // A IA calcula a direção do vetor entre ela e o jogador
            const direction = new THREE.Vector3();
            direction.subVectors(player.position, enemyIA.position).normalize();
            
            // Aplica o movimento
            enemyIA.position.addScaledVector(direction, speed);
            
            // Faz o cubo "olhar" para o jogador
            enemyIA.lookAt(player.position);

            // Atualiza Interface
            const dist = enemyIA.position.distanceTo(player.position);
            document.getElementById('distancia').innerText = dist.toFixed(2);
            
            if(dist < 1) {
                document.getElementById('ia-status').innerText = "ALVO CAPTURADO!";
                document.getElementById('ia-status').style.color = "red";
            } else {
                document.getElementById('ia-status').innerText = "Rastreando Alvo...";
                document.getElementById('ia-status').style.color = "#00ff00";
            }
        }

        // Loop de Animação
        function animate() {
            requestAnimationFrame(animate);

            // Movimento do Jogador
            const pSpeed = 0.15;
            if (keys['w'] || keys['arrowup']) player.position.z -= pSpeed;
            if (keys['s'] || keys['arrowdown']) player.position.z += pSpeed;
            if (keys['a'] || keys['arrowleft']) player.position.x -= pSpeed;
            if (keys['d'] || keys['arrowright']) player.position.x += pSpeed;

            // IA raciocinando
            updateIA();

            // Câmera segue levemente o jogador
            camera.position.x += (player.position.x - camera.position.x) * 0.05;
            camera.position.z += (player.position.z + 15 - camera.position.z) * 0.05;

            renderer.render(scene, camera);
        }

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        animate();
    </script>
</body>
</html>
