<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Meu Parkour HTML</title>
    <style>
        body { margin: 0; overflow: hidden; background: #87CEEB; font-family: sans-serif; }
        canvas { display: block; background: #f0f0f0; border: 5px solid #333; margin: 20px auto; }
        .instrucoes { text-align: center; color: #333; }
    </style>
</head>
<body>
    <div class="instrucoes">
        <h1>Parkour 2D</h1>
        <p>Use as <b>Setas</b> ou <b>A/D</b> para mover | <b>Espaço</b> ou <b>Seta Cima</b> para Pular</p>
    </div>
    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        canvas.width = 800;
        canvas.height = 400;

        // Configurações do Jogador
        const player = {
            x: 50,
            y: 300,
            width: 30,
            height: 30,
            color: "#007bff",
            speed: 5,
            xVelocity: 0,
            yVelocity: 0,
            jumping: true,
            jumpStrength: -15
        };

        const gravity = 0.8;
        const keys = {};

        // Plataformas (x, y, largura, altura)
        const platforms = [
            { x: 0, y: 380, w: 200, h: 20 },   // Chão inicial
            { x: 250, y: 300, w: 100, h: 20 }, // Plataforma 1
            { x: 400, y: 220, w: 100, h: 20 }, // Plataforma 2
            { x: 550, y: 150, w: 100, h: 20 }, // Plataforma 3
            { x: 700, y: 100, w: 50, h: 10, goal: true } // OBJETIVO FINAL (Verde)
        ];

        window.addEventListener("keydown", e => keys[e.code] = true);
        window.addEventListener("keyup", e => keys[e.code] = false);

        function update() {
            // Movimento lateral
            if (keys["ArrowRight"] || keys["KeyD"]) player.xVelocity = player.speed;
            else if (keys["ArrowLeft"] || keys["KeyA"]) player.xVelocity = -player.speed;
            else player.xVelocity = 0;

            // Pulo
            if ((keys["Space"] || keys["ArrowUp"] || keys["KeyW"]) && !player.jumping) {
                player.yVelocity = player.jumpStrength;
                player.jumping = true;
            }

            // Gravidade
            player.yVelocity += gravity;
            player.x += player.xVelocity;
            player.y += player.yVelocity;

            // Colisão com plataformas
            player.jumping = true;
            for (let plat of platforms) {
                if (player.x < plat.x + plat.w &&
                    player.x + player.width > plat.x &&
                    player.y < plat.y + plat.h &&
                    player.y + player.height > plat.y) {
                    
                    // Se tocar na plataforma verde, venceu
                    if(plat.goal) {
                        alert("Você venceu!");
                        resetGame();
                    }

                    // Impedir cair através da plataforma
                    if (player.yVelocity > 0) {
                        player.jumping = false;
                        player.y = plat.y - player.height;
                        player.yVelocity = 0;
                    }
                }
            }

            // Resetar se cair no buraco
            if (player.y > canvas.height) resetGame();

            draw();
            requestAnimationFrame(update);
        }

        function resetGame() {
            player.x = 50;
            player.y = 300;
            player.yVelocity = 0;
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Desenhar plataformas
            platforms.forEach(plat => {
                ctx.fillStyle = plat.goal ? "#28a745" : "#555";
                ctx.fillRect(plat.x, plat.y, plat.w, plat.h);
            });

            // Desenhar jogador
            ctx.fillStyle = player.color;
            ctx.fillRect(player.x, player.y, player.width, player.height);
        }

        update();
    </script>
</body>
</html>
